<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>How Can Data Science Contribute to Understanding the Khipu Code? - Khipu Grammars</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="./site_libs/quarto-nav/quarto-nav.js"></script>
<script src="./site_libs/clipboard/clipboard.min.js"></script>
<script src="./site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="./site_libs/quarto-search/fuse.min.js"></script>
<script src="./site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="./site_libs/quarto-html/quarto.js"></script>
<script src="./site_libs/quarto-html/popper.min.js"></script>
<script src="./site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="./site_libs/quarto-html/anchor.min.js"></script>
<link href="./site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="./site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./site_libs/bootstrap/bootstrap.min.js"></script>
<link href="./site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="./site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="./styles.css">
</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#contiguous-sum-cords" id="toc-contiguous-sum-cords" class="nav-link" data-scroll-target="#contiguous-sum-cords">1.1. Contiguous Sum Cords</a></li>
  <li><a href="#neighboring-sum-cords" id="toc-neighboring-sum-cords" class="nav-link" data-scroll-target="#neighboring-sum-cords">2.2 Neighboring Sum Cords</a></li>
  <li><a href="#white-as-a-leading-cord-color" id="toc-white-as-a-leading-cord-color" class="nav-link" data-scroll-target="#white-as-a-leading-cord-color">2.3 White as a Leading Cord Color</a></li>
  </ul></li>
  <li><a href="#pendant-pendant-sums-by-color" id="toc-pendant-pendant-sums-by-color" class="nav-link" data-scroll-target="#pendant-pendant-sums-by-color">2 Pendant Pendant Sums by Color</a>
  <ul class="collapse">
  <li><a href="#neighboring-sum-cords-1" id="toc-neighboring-sum-cords-1" class="nav-link" data-scroll-target="#neighboring-sum-cords-1">2.1 Neighboring Sum Cords</a></li>
  <li><a href="#white-as-a-leading-cord-color-1" id="toc-white-as-a-leading-cord-color-1" class="nav-link" data-scroll-target="#white-as-a-leading-cord-color-1">2.2 White as a Leading Cord Color</a></li>
  </ul></li>
  <li><a href="#ascher-color-distribution-of-pendant-pendant-sums" id="toc-ascher-color-distribution-of-pendant-pendant-sums" class="nav-link" data-scroll-target="#ascher-color-distribution-of-pendant-pendant-sums">3 Ascher Color Distribution of Pendant Pendant Sums</a>
  <ul class="collapse">
  <li><a href="#cord-clindaniel-color-code" id="toc-cord-clindaniel-color-code" class="nav-link" data-scroll-target="#cord-clindaniel-color-code">3.1 - 3 Cord Clindaniel Color Code</a></li>
  <li><a href="#white-cord-color-distributions" id="toc-white-cord-color-distributions" class="nav-link" data-scroll-target="#white-cord-color-distributions">3.2 White Cord Color Distributions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Khipu Grammars</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<link rel="stylesheet" type="text/css" href="https://www.khipufieldguide.com/css/tufte_fonts.css"> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source Code Pro">
<hr>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This page contains companion expository text and code for the article <strong><em>“How Can Data Science Contribute to Understanding the Khipu Code?”</em></strong> <i>by Manuel Medrano and Ashok Khosla.</i>. More information is available at the Khipu Fieldmarks <a href="https://www.khipufieldguide.com/notebook/analyses/ascher_sums_overview.html">Ascher Sums Relationship</a> page.</p>
<p>Code to show the nature of sum clusters, and white cords is located below:</p>
<section id="contiguous-sum-cords" class="level3">
<h3 class="anchored" data-anchor-id="contiguous-sum-cords">1.1. Contiguous Sum Cords</h3>
<p>Contiguous sum cords compose 53% of all pendant-pendant sum cords in the corpus.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-2"><a href="#cb1-2"></a>warnings.filterwarnings(<span class="st">'ignore'</span>) <span class="co"># Pandas gives warning we can ignore</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>(khipu_dict, all_khipus) <span class="op">=</span> kamayuq.fetch_khipus()</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a>ppsum_df <span class="op">=</span> pd.read_csv(<span class="st">"../data/ascher_sum_relations/pendant_pendant_sum_relation.csv"</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a>pps_khipus <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(<span class="bu">list</span>(ppsum_df.name.values))))</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> ascher_xray_pendant_sum <span class="im">import</span> Ascher_XRay_Pendant_Sum</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Reference code from the Ascher Sum Spreadsheet class</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">def</span> num_stranded_sum_cords():</span>
<span id="cb1-12"><a href="#cb1-12"></a>    <span class="co"># Sort sum cord relations by cluster position then cord position</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>    <span class="kw">def</span> cord_sort_key(aRelation): <span class="cf">return</span> (aRelation.sum_cord.parent_cluster.position(), aRelation.sum_cord.position())</span>
<span id="cb1-14"><a href="#cb1-14"></a>    sorted_relations <span class="op">=</span> <span class="bu">sorted</span>(<span class="va">self</span>.sum_relations, key<span class="op">=</span>cord_sort_key) </span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a>    num_stranded <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a>    split_by_cluster_relations <span class="op">=</span> ku.split_list(sorted_relations, <span class="kw">lambda</span> tuple_item: (tuple_item[<span class="dv">0</span>].sum_cord.parent_cluster.position() <span class="op">!=</span> tuple_item[<span class="dv">1</span>].sum_cord.parent_cluster.position()))</span>
<span id="cb1-19"><a href="#cb1-19"></a>    <span class="cf">for</span> index,cluster_relations <span class="kw">in</span> <span class="bu">enumerate</span>(split_by_cluster_relations):</span>
<span id="cb1-20"><a href="#cb1-20"></a>        <span class="cf">if</span> <span class="bu">len</span>(cluster_relations) <span class="op">&gt;</span> <span class="dv">1</span>: <span class="co"># Only one sum cord in a cluster? Don't worry about it.</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>            noncontiguous_relations <span class="op">=</span> ku.split_list(cluster_relations, <span class="kw">lambda</span> tuple_item: (tuple_item[<span class="dv">0</span>].sum_cord.position()<span class="op">+</span><span class="dv">1</span> <span class="op">!=</span> tuple_item[<span class="dv">1</span>].sum_cord.position()))    </span>
<span id="cb1-22"><a href="#cb1-22"></a>            contiguous_relations <span class="op">=</span> ku.keep(noncontiguous_relations, <span class="kw">lambda</span> x : <span class="bu">len</span>(x)<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb1-23"><a href="#cb1-23"></a>            num_stranded_in_cluster <span class="op">=</span> <span class="bu">len</span>(ku.flatten_list(noncontiguous_relations)) <span class="op">-</span> <span class="bu">len</span>(ku.flatten_list(contiguous_relations))</span>
<span id="cb1-24"><a href="#cb1-24"></a>            num_stranded <span class="op">+=</span> num_stranded_in_cluster</span>
<span id="cb1-25"><a href="#cb1-25"></a></span>
<span id="cb1-26"><a href="#cb1-26"></a>    <span class="cf">return</span> num_stranded</span>
<span id="cb1-27"><a href="#cb1-27"></a></span>
<span id="cb1-28"><a href="#cb1-28"></a>table_df <span class="op">=</span> pd.DataFrame(columns <span class="op">=</span> [<span class="st">'name'</span>, <span class="st">'num_stranded_sum_cords'</span>, <span class="st">'num_contiguous_neighors'</span>, <span class="st">'num_sum_cords'</span>])</span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="cf">for</span> aKhipuName <span class="kw">in</span> pps_khipus:</span>
<span id="cb1-30"><a href="#cb1-30"></a>    khipu <span class="op">=</span> khipu_dict[aKhipuName]</span>
<span id="cb1-31"><a href="#cb1-31"></a>    <span class="cf">try</span>:</span>
<span id="cb1-32"><a href="#cb1-32"></a>        khipu_ss <span class="op">=</span> Ascher_XRay_Pendant_Sum(khipu, csv_filename<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>ku<span class="sc">.</span>fieldmarks_directory()<span class="sc">}</span><span class="ss">/CSV/pendant_pendant_sum_relation.csv"</span>)</span>
<span id="cb1-33"><a href="#cb1-33"></a>        num_stranded_neighbors <span class="op">=</span> khipu_ss.num_stranded_sum_cords()</span>
<span id="cb1-34"><a href="#cb1-34"></a>        num_sums <span class="op">=</span> <span class="bu">len</span>(khipu_ss.sum_relations)</span>
<span id="cb1-35"><a href="#cb1-35"></a>        num_contiguous_neighors <span class="op">=</span> num_sums <span class="op">-</span> num_stranded_neighbors</span>
<span id="cb1-36"><a href="#cb1-36"></a>        table_df <span class="op">=</span> table_df.append({<span class="st">'name'</span>:khipu.name(), </span>
<span id="cb1-37"><a href="#cb1-37"></a>                                    <span class="st">'num_stranded_sum_cords'</span>:num_stranded_neighbors,</span>
<span id="cb1-38"><a href="#cb1-38"></a>                                    <span class="st">'num_contiguous_neighors'</span>:num_contiguous_neighors, </span>
<span id="cb1-39"><a href="#cb1-39"></a>                                    <span class="st">'num_sum_cords'</span>:num_sums,</span>
<span id="cb1-40"><a href="#cb1-40"></a>                                }, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-41"><a href="#cb1-41"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-42"><a href="#cb1-42"></a>        <span class="bu">print</span>(<span class="ss">f"Unable to process </span><span class="sc">{</span>aKhipuName<span class="op">=</span><span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-43"><a href="#cb1-43"></a></span>
<span id="cb1-44"><a href="#cb1-44"></a>total_stranded <span class="op">=</span> <span class="bu">sum</span>(table_df.num_stranded_sum_cords.values)</span>
<span id="cb1-45"><a href="#cb1-45"></a>total_contiguous <span class="op">=</span> <span class="bu">sum</span>(table_df.num_contiguous_neighors.values)</span>
<span id="cb1-46"><a href="#cb1-46"></a>total_sums <span class="op">=</span> <span class="bu">sum</span>(table_df.num_sum_cords.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="bu">print</span>(<span class="ss">f"Solitary Sum Cords as Percent of ALL Sum Cords = </span><span class="sc">{</span>ku<span class="sc">.</span>as_percent_string(total_stranded, total_sums)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="bu">print</span>(<span class="ss">f"Contiguous Sum Cords as Percent of ALL Sum Cords = </span><span class="sc">{</span>ku<span class="sc">.</span>as_percent_string(total_contiguous, total_sums)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Solitary Sum Cords as Percent of ALL Sum Cords = 47%
Contiguous Sum Cords as Percent of ALL Sum Cords = 53%</code></pre>
</div>
</div>
</section>
<section id="neighboring-sum-cords" class="level3">
<h3 class="anchored" data-anchor-id="neighboring-sum-cords">2.2 Neighboring Sum Cords</h3>
<p>For any given sum cluster, 86% of the time, both of its neighboring groups are either additional sum clusters (75%) or knotless cord clusters (11%)</p>
<p>https://www.khipufieldmarks.com/analyses/pendant_pendant_sum_location.html#sum-clusters-neighbors</p>
</section>
<section id="white-as-a-leading-cord-color" class="level3">
<h3 class="anchored" data-anchor-id="white-as-a-leading-cord-color">2.3 White as a Leading Cord Color</h3>
<p>In some 41% of cases, a white pendant cord begins a sum cluster, compared to just 32% for cord groups overall</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">from</span> collections <span class="im">import</span> OrderedDict, Counter</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="im">from</span> ascher_xray_pendant_sum <span class="im">import</span> Ascher_XRay_Pendant_Sum</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>ppsum_df <span class="op">=</span> pd.read_csv(<span class="st">"../data/ascher_sum_relations/pendant_pendant_sum_relation.csv"</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>pps_khipus <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(<span class="bu">list</span>(ppsum_df.name.values))))</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">def</span> build_pendant_color_frequencies():</span>
<span id="cb4-8"><a href="#cb4-8"></a>    ascher_colors <span class="op">=</span> []</span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="cf">for</span> aKhipu <span class="kw">in</span> all_khipus:</span>
<span id="cb4-10"><a href="#cb4-10"></a>        khipu_cords <span class="op">=</span> aKhipu.pendant_cords()</span>
<span id="cb4-11"><a href="#cb4-11"></a>        <span class="cf">for</span> cord_index, aCord <span class="kw">in</span> <span class="bu">enumerate</span>(khipu_cords):</span>
<span id="cb4-12"><a href="#cb4-12"></a>            cord_colors <span class="op">=</span> [aColor.full_color <span class="cf">for</span> aColor <span class="kw">in</span> aCord.ascher_cord_colors]</span>
<span id="cb4-13"><a href="#cb4-13"></a>            <span class="cf">if</span> <span class="bu">len</span>(cord_colors)<span class="op">&gt;</span><span class="dv">0</span>: ascher_colors <span class="op">+=</span> cord_colors</span>
<span id="cb4-14"><a href="#cb4-14"></a>    </span>
<span id="cb4-15"><a href="#cb4-15"></a>    <span class="cf">return</span> OrderedDict(Counter(ascher_colors).most_common()) </span>
<span id="cb4-16"><a href="#cb4-16"></a></span>
<span id="cb4-17"><a href="#cb4-17"></a>pendant_color_frequency_dict <span class="op">=</span> build_pendant_color_frequencies()</span>
<span id="cb4-18"><a href="#cb4-18"></a></span>
<span id="cb4-19"><a href="#cb4-19"></a>colors <span class="op">=</span> []</span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="cf">for</span> aKhipuName <span class="kw">in</span> pps_khipus:</span>
<span id="cb4-21"><a href="#cb4-21"></a>    khipu <span class="op">=</span> khipu_dict[aKhipuName]</span>
<span id="cb4-22"><a href="#cb4-22"></a>    khipu_ss <span class="op">=</span> Ascher_XRay_Pendant_Sum(khipu, csv_filename<span class="op">=</span><span class="ss">f"../data/ascher_sum_relations/pendant_pendant_sum_relation.csv"</span>)</span>
<span id="cb4-23"><a href="#cb4-23"></a>    contiguous_sum_clusters <span class="op">=</span> khipu_ss.contiguous_sum_ranges()</span>
<span id="cb4-24"><a href="#cb4-24"></a>    <span class="cf">if</span> <span class="bu">len</span>(contiguous_sum_clusters)<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb4-25"><a href="#cb4-25"></a>        contiguous_cluster_indices <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([cluster_index <span class="cf">for</span> (cluster_index,aStartEndTuple) <span class="kw">in</span> contiguous_sum_clusters]))</span>
<span id="cb4-26"><a href="#cb4-26"></a>        <span class="cf">for</span> cluster_index <span class="kw">in</span> contiguous_cluster_indices:</span>
<span id="cb4-27"><a href="#cb4-27"></a>            colors.append(khipu[cluster_index][<span class="dv">0</span>].longest_ascher_color())</span>
<span id="cb4-28"><a href="#cb4-28"></a>color_count <span class="op">=</span> Counter(colors)</span>
<span id="cb4-29"><a href="#cb4-29"></a>color_count.most_common(<span class="dv">10</span>)</span>
<span id="cb4-30"><a href="#cb4-30"></a>first_cord_color_dict <span class="op">=</span> {x:y <span class="cf">for</span> (x,y) <span class="kw">in</span> color_count.most_common()}</span>
<span id="cb4-31"><a href="#cb4-31"></a>total_count <span class="op">=</span> <span class="bu">sum</span>([count <span class="cf">for</span> (color,count) <span class="kw">in</span> first_cord_color_dict.items()])</span>
<span id="cb4-32"><a href="#cb4-32"></a>white_count <span class="op">=</span> color_count.most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">1</span>]</span>
<span id="cb4-33"><a href="#cb4-33"></a>percent_white_as_first_cord <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>white_count<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>total_count<span class="sc">}</span><span class="ss">(</span><span class="sc">{</span><span class="bu">round</span>(<span class="fl">100.0</span><span class="op">*</span><span class="bu">float</span>(white_count)<span class="op">/</span><span class="bu">float</span>(total_count))<span class="sc">}</span><span class="ss">%)"</span></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="bu">print</span>(<span class="ss">f"(# of pendant-pendant sum clusters with white as first cord)/(# of clusters) = </span><span class="sc">{</span>percent_white_as_first_cord<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>[('W', 295),
 ('AB', 103),
 ('MB', 65),
 ('B', 49),
 ('YB', 39),
 ('KB', 18),
 ('W:AB', 16),
 ('RB', 14),
 ('W:MB', 13),
 ('AB:MB', 12)]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(# of pendant-pendant sum clusters with white as first cord)/(# of clusters) = 295/800(37%)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">def</span> num_clusters_with_white_first():</span>
<span id="cb7-2"><a href="#cb7-2"></a>    num_clusters <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>    num_white_leading_clusters <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="co">""" Calculate the total number of clusters in all khipus that start with a white cord """</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="cf">for</span> aKhipu <span class="kw">in</span> all_khipus:</span>
<span id="cb7-6"><a href="#cb7-6"></a>        primary_cord_clusters <span class="op">=</span> aKhipu[:]</span>
<span id="cb7-7"><a href="#cb7-7"></a>        num_clusters <span class="op">+=</span> <span class="bu">len</span>(primary_cord_clusters)</span>
<span id="cb7-8"><a href="#cb7-8"></a>        first_cord_colors <span class="op">=</span> [cluster.pendant_cords()[<span class="dv">0</span>].longest_ascher_color() <span class="cf">for</span> cluster <span class="kw">in</span> primary_cord_clusters <span class="cf">if</span> cluster.pendant_cords()]</span>
<span id="cb7-9"><a href="#cb7-9"></a>        num_white_leading_clusters <span class="op">+=</span> <span class="bu">sum</span>([color <span class="op">==</span> <span class="st">'W'</span><span class="cf">for</span> color <span class="kw">in</span> first_cord_colors])</span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="cf">return</span>(num_white_leading_clusters, num_clusters)</span>
<span id="cb7-11"><a href="#cb7-11"></a></span>
<span id="cb7-12"><a href="#cb7-12"></a>(num_white_leading_clusters, num_clusters) <span class="op">=</span> num_clusters_with_white_first()</span>
<span id="cb7-13"><a href="#cb7-13"></a>percent_white_as_first_cord <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>num_white_leading_clusters<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_clusters<span class="sc">}</span><span class="ss">(</span><span class="sc">{</span><span class="bu">round</span>(<span class="fl">100.0</span><span class="op">*</span><span class="bu">float</span>(num_white_leading_clusters)<span class="op">/</span><span class="bu">float</span>(num_clusters))<span class="sc">}</span><span class="ss">%)"</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="bu">print</span>(<span class="ss">f"(# of clusters with white as first cord)/(# of clusters) = </span><span class="sc">{</span>percent_white_as_first_cord<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(# of clusters with white as first cord)/(# of clusters) = 2660/8192(32%)</code></pre>
</div>
</div>
</section>
</section>
<section id="pendant-pendant-sums-by-color" class="level2">
<h2 class="anchored" data-anchor-id="pendant-pendant-sums-by-color">2 Pendant Pendant Sums by Color</h2>
<section id="neighboring-sum-cords-1" class="level3">
<h3 class="anchored" data-anchor-id="neighboring-sum-cords-1">2.1 Neighboring Sum Cords</h3>
<p>Pendant pendant sums by color exhibit similar properties:, with sum clusters also flanked by additional sum clusters (70%) or knotless groups (18%) in 88% of cases.</p>
<p>https://www.khipufieldmarks.com/analyses/pendant_pendants_color_sum.html#sum-clusters-neighbors</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>pcsum_df <span class="op">=</span> pd.read_csv(<span class="st">"../data/ascher_sum_relations/pendant_pendants_color_sum_relation.csv"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>pcs_khipus <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(<span class="bu">list</span>(pcsum_df.name.values))))</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a>num_left_zeros <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>num_right_zeros <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>num_both_zeros <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>num_no_zeros <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>num_sums <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="cf">for</span> aKhipuName <span class="kw">in</span> pcs_khipus:</span>
<span id="cb9-10"><a href="#cb9-10"></a>    khipu <span class="op">=</span> khipu_dict[aKhipuName]</span>
<span id="cb9-11"><a href="#cb9-11"></a>    khipu_ss <span class="op">=</span> Ascher_XRay_Pendant_Sum(khipu, csv_filename<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>ku<span class="sc">.</span>fieldmarks_directory()<span class="sc">}</span><span class="ss">/CSV/pendant_pendants_color_sum_relation.csv"</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a>    contiguous_sum_clusters <span class="op">=</span> khipu_ss.contiguous_sum_ranges()</span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="cf">if</span> <span class="bu">len</span>(contiguous_sum_clusters)<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb9-14"><a href="#cb9-14"></a>        contiguous_cluster_indices <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([cluster_index <span class="cf">for</span> (cluster_index,aStartEndTuple) <span class="kw">in</span> contiguous_sum_clusters]))</span>
<span id="cb9-15"><a href="#cb9-15"></a>        right_cluster_indices <span class="op">=</span> [cluster_index <span class="cf">for</span> cluster_index <span class="kw">in</span> contiguous_cluster_indices <span class="cf">if</span> cluster_index <span class="op">&gt;</span> <span class="dv">4</span>]</span>
<span id="cb9-16"><a href="#cb9-16"></a>        <span class="cf">for</span> index <span class="kw">in</span> right_cluster_indices:</span>
<span id="cb9-17"><a href="#cb9-17"></a>            left_zero <span class="op">=</span> khipu[index<span class="op">-</span><span class="dv">1</span>].cluster_cord_sum() <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>            right_zero <span class="op">=</span> (index <span class="op">&lt;</span> khipu.num_cord_clusters()<span class="op">-</span><span class="dv">1</span>) <span class="kw">and</span> (khipu[index<span class="op">+</span><span class="dv">1</span>].cluster_cord_sum() <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb9-19"><a href="#cb9-19"></a>            <span class="cf">if</span> left_zero: num_left_zeros <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>            <span class="cf">if</span> right_zero: num_right_zeros <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>            <span class="cf">if</span> left_zero <span class="kw">and</span> right_zero: num_both_zeros <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb9-22"><a href="#cb9-22"></a>            <span class="cf">if</span> <span class="kw">not</span> left_zero <span class="kw">and</span> <span class="kw">not</span> right_zero: num_no_zeros <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb9-23"><a href="#cb9-23"></a>            num_sums <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>ku<span class="sc">.</span>as_percent_string(num_left_zeros,num_sums)<span class="sc">}</span><span class="ss"> of Sum Clusters have a 0-sum cord cluster to their Left"</span>)</span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>ku<span class="sc">.</span>as_percent_string(num_right_zeros,num_sums)<span class="sc">}</span><span class="ss"> of Sum Clusters have a 0-sum cord cluster to their Right"</span>)</span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>ku<span class="sc">.</span>as_percent_string(num_both_zeros,num_sums)<span class="sc">}</span><span class="ss"> of Sum Clusters have a 0-sum cord cluster on BOTH their Left and Right"</span>)</span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>ku<span class="sc">.</span>as_percent_string(num_no_zeros,num_sums)<span class="sc">}</span><span class="ss"> of Sum Clusters have a NON-ZERO sum cord cluster on BOTH their Left and Right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>24% of Sum Clusters have a 0-sum cord cluster to their Left
25% of Sum Clusters have a 0-sum cord cluster to their Right
18% of Sum Clusters have a 0-sum cord cluster on BOTH their Left and Right
70% of Sum Clusters have a NON-ZERO sum cord cluster on BOTH their Left and Right</code></pre>
</div>
</div>
</section>
<section id="white-as-a-leading-cord-color-1" class="level3">
<h3 class="anchored" data-anchor-id="white-as-a-leading-cord-color-1">2.2 White as a Leading Cord Color</h3>
<p>The same holds for pendant sums by color (relation no. 2 in table 1), in which 40% of sum clusters also begin with a white cord</p>
<p>https://www.khipufieldmarks.com/analyses/pendant_pendants_color_sum.html#sum-clusters-neighbors</p>
</section>
</section>
<section id="ascher-color-distribution-of-pendant-pendant-sums" class="level2">
<h2 class="anchored" data-anchor-id="ascher-color-distribution-of-pendant-pendant-sums">3 Ascher Color Distribution of Pendant Pendant Sums</h2>
<section id="cord-clindaniel-color-code" class="level3">
<h3 class="anchored" data-anchor-id="cord-clindaniel-color-code">3.1 - 3 Cord Clindaniel Color Code</h3>
<p>Brute-force search reveals that three-cord “grammatical” color sequences of the type proposed by Clindaniel – light cord minus dark cord equals mixed-color cord – are exceedingly rare, appearing on only six other cords (i.e., two other times) in the 650-khipu corpus.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>(khipu_dict, all_khipus) <span class="op">=</span> kamayuq.fetch_khipus()</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="im">from</span> fieldmark_ascher_pendant_pendant_sum <span class="im">import</span> Fieldmark_Pendant_Pendant_Sum</span>
<span id="cb11-3"><a href="#cb11-3"></a>aFieldmark <span class="op">=</span> Fieldmark_Pendant_Pendant_Sum()</span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a>sum_cord_df <span class="op">=</span> pd.read_csv(<span class="st">"../data/ascher_sum_relations/pendant_pendant_sum_relation.csv"</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a>khipu_names <span class="op">=</span> sum_cord_df.name.to_list()</span>
<span id="cb11-7"><a href="#cb11-7"></a>sum_strings <span class="op">=</span> sum_cord_df.sum_string.to_list()</span>
<span id="cb11-8"><a href="#cb11-8"></a>khipus <span class="op">=</span> [khipu_dict[name] <span class="cf">for</span> name <span class="kw">in</span> khipu_names]</span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="kw">def</span> fetch_summand_colors(index):</span>
<span id="cb11-10"><a href="#cb11-10"></a>    cords <span class="op">=</span> aFieldmark.cords_from_sum_string(khipus[index], sum_strings[index], one_based<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a>    <span class="cf">return</span> <span class="bu">sorted</span>([aCord.longest_ascher_color() <span class="cf">for</span> aCord <span class="kw">in</span> cords], key<span class="op">=</span><span class="kw">lambda</span> x: <span class="bu">len</span>(x))</span>
<span id="cb11-12"><a href="#cb11-12"></a></span>
<span id="cb11-13"><a href="#cb11-13"></a>the_summand_cord_colors <span class="op">=</span> [fetch_summand_colors(index) <span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sum_cord_df))]</span>
<span id="cb11-14"><a href="#cb11-14"></a>the_summand_cord_reps <span class="op">=</span> [<span class="st">", "</span>.join(val) <span class="cf">for</span> val <span class="kw">in</span> the_summand_cord_colors]</span>
<span id="cb11-15"><a href="#cb11-15"></a>sum_cord_df <span class="op">=</span> sum_cord_df.assign(summand_colors<span class="op">=</span>the_summand_cord_reps)</span>
<span id="cb11-16"><a href="#cb11-16"></a></span>
<span id="cb11-17"><a href="#cb11-17"></a>two_summand_df <span class="op">=</span> sum_cord_df[sum_cord_df.num_summands<span class="op">==</span><span class="dv">2</span>]</span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="kw">def</span> is_contiguous_sum(sum_cord, summand_cords):</span>
<span id="cb11-19"><a href="#cb11-19"></a>    <span class="cf">if</span> (sum_cord <span class="kw">is</span> <span class="va">None</span>) <span class="kw">or</span> <span class="kw">not</span> (summand_cords): <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>    <span class="cf">try</span>:</span>
<span id="cb11-21"><a href="#cb11-21"></a>        sum_cord_position <span class="op">=</span> sum_cord.pendant_index()</span>
<span id="cb11-22"><a href="#cb11-22"></a>        min_summand_position <span class="op">=</span> <span class="bu">min</span>(summand_cords[<span class="dv">0</span>].pendant_index(), summand_cords[<span class="dv">1</span>].pendant_index())</span>
<span id="cb11-23"><a href="#cb11-23"></a>        max_summand_position <span class="op">=</span> <span class="bu">max</span>(summand_cords[<span class="dv">0</span>].pendant_index(), summand_cords[<span class="dv">1</span>].pendant_index())</span>
<span id="cb11-24"><a href="#cb11-24"></a>        <span class="cf">return</span> (min_summand_position <span class="op">==</span> sum_cord_position <span class="op">+</span> <span class="dv">1</span>) <span class="kw">and</span> (max_summand_position <span class="op">==</span> min_summand_position <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb11-25"><a href="#cb11-25"></a>    <span class="cf">except</span>:</span>
<span id="cb11-26"><a href="#cb11-26"></a>        <span class="co">#print(f"Error is_contiguous_sum({sum_cord=},:{summand_cords=})")</span></span>
<span id="cb11-27"><a href="#cb11-27"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb11-28"><a href="#cb11-28"></a></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="kw">def</span> fetch_sum_cord(index):</span>
<span id="cb11-30"><a href="#cb11-30"></a>    <span class="cf">try</span>:</span>
<span id="cb11-31"><a href="#cb11-31"></a>        khipu_name <span class="op">=</span> kq.kfg_name_from_id(two_summand_df.iloc[index].khipu_id)</span>
<span id="cb11-32"><a href="#cb11-32"></a>        khipu <span class="op">=</span> khipu_dict[khipu_name]</span>
<span id="cb11-33"><a href="#cb11-33"></a>        cord_name <span class="op">=</span> two_summand_df.iloc[index].cord_name</span>
<span id="cb11-34"><a href="#cb11-34"></a>        cord <span class="op">=</span> khipu[cord_name]</span>
<span id="cb11-35"><a href="#cb11-35"></a>    <span class="cf">except</span>:</span>
<span id="cb11-36"><a href="#cb11-36"></a>        <span class="bu">print</span>(<span class="ss">f"Error fetching sum cords for index </span><span class="sc">{</span>index<span class="sc">}</span><span class="ss">: khipu_name:</span><span class="sc">{</span>khipu_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-37"><a href="#cb11-37"></a>        cord <span class="op">=</span> <span class="va">None</span>        </span>
<span id="cb11-38"><a href="#cb11-38"></a>    <span class="cf">return</span> cord</span>
<span id="cb11-39"><a href="#cb11-39"></a><span class="kw">def</span> fetch_summand_cords(index):</span>
<span id="cb11-40"><a href="#cb11-40"></a>    summand_string <span class="op">=</span> two_summand_df.iloc[index].sum_string.strip()</span>
<span id="cb11-41"><a href="#cb11-41"></a>    <span class="cf">try</span>:</span>
<span id="cb11-42"><a href="#cb11-42"></a>        khipu_name <span class="op">=</span> kq.kfg_name_from_id(two_summand_df.iloc[index].khipu_id)</span>
<span id="cb11-43"><a href="#cb11-43"></a>        khipu <span class="op">=</span> khipu_dict[khipu_name]</span>
<span id="cb11-44"><a href="#cb11-44"></a>        cords <span class="op">=</span> aFieldmark.cords_from_sum_string(khipu, summand_string, one_based<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-45"><a href="#cb11-45"></a>    <span class="cf">except</span> :</span>
<span id="cb11-46"><a href="#cb11-46"></a>        <span class="co">#print(f"Error fetching summand cords for index {index}: {summand_string}")</span></span>
<span id="cb11-47"><a href="#cb11-47"></a>        cords <span class="op">=</span> []</span>
<span id="cb11-48"><a href="#cb11-48"></a></span>
<span id="cb11-49"><a href="#cb11-49"></a>    <span class="cf">return</span> cords</span>
<span id="cb11-50"><a href="#cb11-50"></a></span>
<span id="cb11-51"><a href="#cb11-51"></a>the_sum_cords<span class="op">=</span> [fetch_sum_cord(index) <span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(two_summand_df))]</span>
<span id="cb11-52"><a href="#cb11-52"></a>mask <span class="op">=</span> [is_contiguous_sum(fetch_sum_cord(index), fetch_summand_cords(index)) <span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(the_sum_cords))]</span>
<span id="cb11-53"><a href="#cb11-53"></a>valid_contigous_sums_df <span class="op">=</span> two_summand_df[mask]</span>
<span id="cb11-54"><a href="#cb11-54"></a><span class="bu">print</span>(<span class="ss">f"There are </span><span class="sc">{</span><span class="bu">len</span>(valid_contigous_sums_df)<span class="sc">}</span><span class="ss"> three-cord contiguous sums where A=B+C and A,B,C are contiguous regardless of cluster boundary"</span>)</span>
<span id="cb11-55"><a href="#cb11-55"></a>valid_contigous_sums_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>There are 187 three-cord contiguous sums where A=B+C and A,B,C are contiguous regardless of cluster boundary</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div><div id="6626805a-3b6b-488a-9dd8-9415b5445bb6" style="display:none; background-color:#9D6CFF; color:white; width:200px; height:30px; padding-left:5px; border-radius:4px; flex-direction:row; justify-content:space-around; align-items:center;" onmouseover="this.style.backgroundColor='#BA9BF8'" onmouseout="this.style.backgroundColor='#9D6CFF'" onclick="window.commands?.execute('create-mitosheet-from-dataframe-output');">See Full Dataframe in Mito</div> <script> if (window.commands.hasCommand('create-mitosheet-from-dataframe-output')) document.getElementById('6626805a-3b6b-488a-9dd8-9415b5445bb6').style.display = 'flex' </script> <table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>khipu_id</th>
      <th>name</th>
      <th>cord_id</th>
      <th>cord_name</th>
      <th>cord_position</th>
      <th>cord_position_index</th>
      <th>cord_value</th>
      <th>cord_color</th>
      <th>num_summands</th>
      <th>sum_string</th>
      <th>handedness</th>
      <th>summand_colors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>50</th>
      <td>50</td>
      <td>1000198</td>
      <td>AS026B</td>
      <td>3017445</td>
      <td>p8</td>
      <td>[0, 7]</td>
      <td>7</td>
      <td>24</td>
      <td>W</td>
      <td>2</td>
      <td>[0, 8]:12 +[0, 9]:12</td>
      <td>1</td>
      <td>W, W</td>
    </tr>
    <tr>
      <th>109</th>
      <td>109</td>
      <td>1000235</td>
      <td>AS036</td>
      <td>3018951</td>
      <td>p39</td>
      <td>[3, 10]</td>
      <td>10</td>
      <td>20</td>
      <td>BB</td>
      <td>2</td>
      <td>[4, 0]:10 +[4, 1]:10</td>
      <td>2</td>
      <td>W, RD</td>
    </tr>
    <tr>
      <th>110</th>
      <td>110</td>
      <td>1000235</td>
      <td>AS036</td>
      <td>3018956</td>
      <td>p44</td>
      <td>[4, 4]</td>
      <td>4</td>
      <td>30</td>
      <td>RD</td>
      <td>2</td>
      <td>[4, 5]:20 +[4, 6]:10</td>
      <td>1</td>
      <td>W, RD</td>
    </tr>
    <tr>
      <th>111</th>
      <td>111</td>
      <td>1000235</td>
      <td>AS036</td>
      <td>3018957</td>
      <td>p45</td>
      <td>[4, 5]</td>
      <td>5</td>
      <td>20</td>
      <td>W</td>
      <td>2</td>
      <td>[4, 6]:10 +[4, 7]:10</td>
      <td>2</td>
      <td>RD, BB</td>
    </tr>
    <tr>
      <th>199</th>
      <td>199</td>
      <td>1000212</td>
      <td>AS045</td>
      <td>3018189</td>
      <td>p28</td>
      <td>[8, 1]</td>
      <td>1</td>
      <td>44</td>
      <td>W</td>
      <td>2</td>
      <td>[8, 2]:26 +[8, 3]:18</td>
      <td>1</td>
      <td>B:LC, B:LC</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8009</th>
      <td>8009</td>
      <td>6000087</td>
      <td>UR190</td>
      <td>6011399</td>
      <td>p357</td>
      <td>[20, 20]</td>
      <td>20</td>
      <td>20</td>
      <td>W</td>
      <td>2</td>
      <td>[20, 21]:10 +[20, 22]:10</td>
      <td>2</td>
      <td>W, W</td>
    </tr>
    <tr>
      <th>8012</th>
      <td>8012</td>
      <td>6000087</td>
      <td>UR190</td>
      <td>6011423</td>
      <td>p381</td>
      <td>[21, 16]</td>
      <td>16</td>
      <td>40</td>
      <td>MB</td>
      <td>2</td>
      <td>[21, 17]:30 +[21, 18]:10</td>
      <td>2</td>
      <td>W, MB</td>
    </tr>
    <tr>
      <th>8013</th>
      <td>8013</td>
      <td>6000087</td>
      <td>UR190</td>
      <td>6011424</td>
      <td>p382</td>
      <td>[21, 17]</td>
      <td>17</td>
      <td>30</td>
      <td>W</td>
      <td>2</td>
      <td>[21, 18]:10 +[21, 19]:20</td>
      <td>1</td>
      <td>MB, KB</td>
    </tr>
    <tr>
      <th>8046</th>
      <td>8046</td>
      <td>6000088</td>
      <td>UR193</td>
      <td>6011500</td>
      <td>p41</td>
      <td>[2, 37]</td>
      <td>37</td>
      <td>120</td>
      <td>W</td>
      <td>2</td>
      <td>[2, 38]:61 +[2, 39]:59</td>
      <td>2</td>
      <td>W, W</td>
    </tr>
    <tr>
      <th>8084</th>
      <td>8084</td>
      <td>6000090</td>
      <td>UR253</td>
      <td>6011752</td>
      <td>p57</td>
      <td>[10, 5]</td>
      <td>5</td>
      <td>21</td>
      <td>0D</td>
      <td>2</td>
      <td>[11, 0]:6 +[11, 1]:15</td>
      <td>2</td>
      <td>AB, W:AB:LK</td>
    </tr>
  </tbody>
</table></div>
</div>
</div>
<p>And of these relationships, how many are of the light=dark+mottled relationship (ie. Clindaniel Inkawasi relationship)?</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Then let's look at LIGHT sum cord sets</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># Then let's look at where the first color is not the same as the second color</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="im">from</span> khipu_cord_color <span class="im">import</span> color_code_to_grey_value</span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="kw">def</span> is_relaxed_clindaniel_relationship(sum_color, summand_color_string):</span>
<span id="cb13-6"><a href="#cb13-6"></a>    summand_colors <span class="op">=</span> [aColor.strip() <span class="cf">for</span> aColor <span class="kw">in</span> summand_color_string.split(<span class="st">","</span>)]</span>
<span id="cb13-7"><a href="#cb13-7"></a>    summand_grey_scales <span class="op">=</span> [color_code_to_grey_value(aColor) <span class="cf">for</span> aColor <span class="kw">in</span> summand_colors]</span>
<span id="cb13-8"><a href="#cb13-8"></a>    <span class="cf">return</span> ((<span class="bu">len</span>(summand_colors)<span class="op">==</span><span class="dv">2</span>) <span class="kw">and</span> </span>
<span id="cb13-9"><a href="#cb13-9"></a>            (summand_colors[<span class="dv">0</span>] <span class="op">!=</span> sum_color) <span class="kw">and</span> </span>
<span id="cb13-10"><a href="#cb13-10"></a>            (summand_colors[<span class="dv">1</span>] <span class="op">!=</span> summand_colors[<span class="dv">0</span>]) <span class="kw">and</span> </span>
<span id="cb13-11"><a href="#cb13-11"></a>            (summand_grey_scales[<span class="dv">0</span>] <span class="op">&lt;</span> <span class="fl">.6</span>) <span class="kw">and</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>            (summand_colors[<span class="dv">0</span>] <span class="kw">in</span> summand_colors[<span class="dv">1</span>]) <span class="kw">and</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>            <span class="co">#(sum_color in summand_colors[1]) and</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>            <span class="kw">not</span>((<span class="st">":"</span> <span class="kw">in</span> summand_colors[<span class="dv">0</span>]) <span class="kw">and</span> (<span class="st">":"</span> <span class="kw">in</span> summand_colors[<span class="dv">1</span>])))</span>
<span id="cb13-15"><a href="#cb13-15"></a>            </span>
<span id="cb13-16"><a href="#cb13-16"></a>selection_mask <span class="op">=</span> [color_code_to_grey_value(aColor)<span class="op">&gt;</span> <span class="fl">0.6</span> <span class="cf">for</span> aColor <span class="kw">in</span> valid_contigous_sums_df.cord_color.to_list()]</span>
<span id="cb13-17"><a href="#cb13-17"></a>light_addition_df <span class="op">=</span> valid_contigous_sums_df[selection_mask]</span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co"># Then let's look at where mottled cords occur in the summand colors</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>selection_mask <span class="op">=</span> [<span class="st">":"</span> <span class="kw">in</span> color <span class="cf">for</span> color <span class="kw">in</span> light_addition_df.summand_colors.to_list()]</span>
<span id="cb13-21"><a href="#cb13-21"></a>mottled_result_df <span class="op">=</span> light_addition_df[selection_mask]</span>
<span id="cb13-22"><a href="#cb13-22"></a>            </span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co"># Then let's look at where a Clindaniel relationship occurs</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>sum_colors <span class="op">=</span> mottled_result_df.cord_color.to_list()</span>
<span id="cb13-25"><a href="#cb13-25"></a>summand_colors <span class="op">=</span> mottled_result_df.summand_colors.to_list()</span>
<span id="cb13-26"><a href="#cb13-26"></a>selection_mask <span class="op">=</span> [is_relaxed_clindaniel_relationship(sum_colors[index], summand_colors[index]) <span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(summand_colors))]</span>
<span id="cb13-27"><a href="#cb13-27"></a>relaxed_contiguous_clindaniel_relationship_df <span class="op">=</span> mottled_result_df[selection_mask]</span>
<span id="cb13-28"><a href="#cb13-28"></a></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="bu">print</span>(<span class="ss">f"There are </span><span class="sc">{</span><span class="bu">len</span>(relaxed_contiguous_clindaniel_relationship_df)<span class="sc">}</span><span class="ss"> three-cord contiguous sums where A=B+C and A,B,C are contiguous regardless of cluster boundary</span><span class="ch">\n</span><span class="ss">WHERE these relationships are of the light=dark+mottled Clindaniel type."</span>)</span>
<span id="cb13-30"><a href="#cb13-30"></a>relaxed_contiguous_clindaniel_relationship_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>There are 3 three-cord contiguous sums where A=B+C and A,B,C are contiguous regardless of cluster boundary
WHERE these relationships are of the light=dark+mottled Clindaniel type.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">

<div><div id="5cb45581-9571-4312-bc05-f7211e0e0608" style="display:none; background-color:#9D6CFF; color:white; width:200px; height:30px; padding-left:5px; border-radius:4px; flex-direction:row; justify-content:space-around; align-items:center;" onmouseover="this.style.backgroundColor='#BA9BF8'" onmouseout="this.style.backgroundColor='#9D6CFF'" onclick="window.commands?.execute('create-mitosheet-from-dataframe-output');">See Full Dataframe in Mito</div> <script> if (window.commands.hasCommand('create-mitosheet-from-dataframe-output')) document.getElementById('5cb45581-9571-4312-bc05-f7211e0e0608').style.display = 'flex' </script> <table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>khipu_id</th>
      <th>name</th>
      <th>cord_id</th>
      <th>cord_name</th>
      <th>cord_position</th>
      <th>cord_position_index</th>
      <th>cord_value</th>
      <th>cord_color</th>
      <th>num_summands</th>
      <th>sum_string</th>
      <th>handedness</th>
      <th>summand_colors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>827</th>
      <td>827</td>
      <td>1000017</td>
      <td>AS210</td>
      <td>3001526</td>
      <td>p26</td>
      <td>[4, 1]</td>
      <td>1</td>
      <td>24</td>
      <td>W</td>
      <td>2</td>
      <td>[4, 2]:1 +[4, 3]:23</td>
      <td>1</td>
      <td>B, W:B</td>
    </tr>
    <tr>
      <th>2207</th>
      <td>2207</td>
      <td>1000336</td>
      <td>UR086</td>
      <td>3030366</td>
      <td>p48</td>
      <td>[9, 2]</td>
      <td>2</td>
      <td>29</td>
      <td>W</td>
      <td>2</td>
      <td>[9, 3]:26 +[10, 0]:3</td>
      <td>1</td>
      <td>AB, W:AB</td>
    </tr>
    <tr>
      <th>5683</th>
      <td>5683</td>
      <td>1000608</td>
      <td>UR267A</td>
      <td>3053846</td>
      <td>p1</td>
      <td>[0, 0]</td>
      <td>0</td>
      <td>106</td>
      <td>W</td>
      <td>2</td>
      <td>[0, 1]:15 +[0, 2]:91</td>
      <td>2</td>
      <td>AB, AB:MB</td>
    </tr>
  </tbody>
</table></div>
</div>
</div>
</section>
<section id="white-cord-color-distributions" class="level3">
<h3 class="anchored" data-anchor-id="white-cord-color-distributions">3.2 White Cord Color Distributions</h3>
<p>The distribution of pendant-pendant sum colors is within 4.5 degrees of similarity to the overall color distribution for <strong>ALL</strong> nonzero-valued pendants</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="im">from</span> collections <span class="im">import</span> OrderedDict, Counter</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="kw">def</span> degrees_between(vec1, vec2):</span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="cf">if</span> <span class="bu">len</span>(vec1) <span class="op">!=</span> <span class="bu">len</span>(vec2):  </span>
<span id="cb15-5"><a href="#cb15-5"></a>        <span class="bu">print</span>(<span class="st">"khipu_utils.degrees_between(vec1, vec2): vectors must be same length"</span>)      </span>
<span id="cb15-6"><a href="#cb15-6"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span></span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a>    vec1 <span class="op">=</span> as_unit_vector(vec1)</span>
<span id="cb15-9"><a href="#cb15-9"></a>    vec2 <span class="op">=</span> as_unit_vector(vec2)</span>
<span id="cb15-10"><a href="#cb15-10"></a>    dot_prod <span class="op">=</span> <span class="bu">sum</span>([ vec1[i]<span class="op">*</span>vec2[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(vec1))])</span>
<span id="cb15-11"><a href="#cb15-11"></a>    <span class="cf">return</span> radians_to_degrees(math.acos(dot_prod))</span>
<span id="cb15-12"><a href="#cb15-12"></a></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="kw">def</span> degrees_between_dicts(dict1, dict2):</span>
<span id="cb15-14"><a href="#cb15-14"></a>    <span class="co">""" Dicts are key frequency pairs, often the output of counter_to_dict """</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>    dict1_keys <span class="op">=</span> <span class="bu">set</span>(<span class="bu">list</span>(dict1.keys()))</span>
<span id="cb15-16"><a href="#cb15-16"></a>    dict2_keys <span class="op">=</span> <span class="bu">set</span>(<span class="bu">list</span>(dict2.keys()))</span>
<span id="cb15-17"><a href="#cb15-17"></a>    common_keys <span class="op">=</span> <span class="bu">list</span>(dict1_keys.intersection(dict2_keys))</span>
<span id="cb15-18"><a href="#cb15-18"></a></span>
<span id="cb15-19"><a href="#cb15-19"></a>    vec1 <span class="op">=</span> [dict1[aKey] <span class="cf">for</span> aKey <span class="kw">in</span> common_keys]</span>
<span id="cb15-20"><a href="#cb15-20"></a>    vec2 <span class="op">=</span> [dict2[aKey] <span class="cf">for</span> aKey <span class="kw">in</span> common_keys]</span>
<span id="cb15-21"><a href="#cb15-21"></a>    theta <span class="op">=</span> degrees_between(vec1, vec2)</span>
<span id="cb15-22"><a href="#cb15-22"></a>    <span class="cf">return</span>(theta)</span>
<span id="cb15-23"><a href="#cb15-23"></a></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="kw">def</span> build_all_pendant_color_frequencies():</span>
<span id="cb15-25"><a href="#cb15-25"></a>    ascher_colors <span class="op">=</span> []</span>
<span id="cb15-26"><a href="#cb15-26"></a>    <span class="cf">for</span> aKhipu <span class="kw">in</span> all_khipus:</span>
<span id="cb15-27"><a href="#cb15-27"></a>        khipu_cords <span class="op">=</span> aKhipu.pendant_cords()</span>
<span id="cb15-28"><a href="#cb15-28"></a>        <span class="cf">for</span> cord_index, aCord <span class="kw">in</span> <span class="bu">enumerate</span>(khipu_cords):</span>
<span id="cb15-29"><a href="#cb15-29"></a>            cord_colors <span class="op">=</span> [aColor.full_color <span class="cf">for</span> aColor <span class="kw">in</span> aCord.ascher_cord_colors]</span>
<span id="cb15-30"><a href="#cb15-30"></a>            <span class="cf">if</span> <span class="bu">len</span>(cord_colors)<span class="op">&gt;</span><span class="dv">0</span>: ascher_colors <span class="op">+=</span> cord_colors</span>
<span id="cb15-31"><a href="#cb15-31"></a>    </span>
<span id="cb15-32"><a href="#cb15-32"></a>    <span class="cf">return</span> OrderedDict(Counter(ascher_colors).most_common()) </span>
<span id="cb15-33"><a href="#cb15-33"></a></span>
<span id="cb15-34"><a href="#cb15-34"></a><span class="kw">def</span> build_pendant_sum_color_frequencies():</span>
<span id="cb15-35"><a href="#cb15-35"></a>    sum_cord_df <span class="op">=</span> pd.read_csv(<span class="st">"../data/ascher_sum_relations/pendant_pendant_sum_relation.csv"</span>)</span>
<span id="cb15-36"><a href="#cb15-36"></a>    <span class="kw">def</span> pendant_color_occurrences(aColor):</span>
<span id="cb15-37"><a href="#cb15-37"></a>        cords_with_color_df <span class="op">=</span> sum_cord_df[sum_cord_df.cord_color<span class="op">==</span>aColor]</span>
<span id="cb15-38"><a href="#cb15-38"></a>        num_occurrences <span class="op">=</span> <span class="bu">len</span>(cords_with_color_df)</span>
<span id="cb15-39"><a href="#cb15-39"></a>        <span class="cf">return</span> num_occurrences</span>
<span id="cb15-40"><a href="#cb15-40"></a></span>
<span id="cb15-41"><a href="#cb15-41"></a>    all_sum_colors <span class="op">=</span> <span class="bu">set</span>(sum_cord_df.cord_color.values)</span>
<span id="cb15-42"><a href="#cb15-42"></a>    sum_color_frequency <span class="op">=</span> [(aColor, pendant_color_occurrences(aColor)) <span class="cf">for</span> aColor <span class="kw">in</span> all_sum_colors]</span>
<span id="cb15-43"><a href="#cb15-43"></a>    sum_color_frequency_df <span class="op">=</span> pd.DataFrame(sum_color_frequency, columns <span class="op">=</span> [<span class="st">'ascher_color'</span>, <span class="st">'num_occurrences'</span>])</span>
<span id="cb15-44"><a href="#cb15-44"></a>    sum_color_frequency_df <span class="op">=</span> sum_color_frequency_df.sort_values(by<span class="op">=</span>[<span class="st">'num_occurrences'</span>], ascending<span class="op">=</span><span class="va">False</span>)<span class="op">;</span></span>
<span id="cb15-45"><a href="#cb15-45"></a></span>
<span id="cb15-46"><a href="#cb15-46"></a>    <span class="cf">return</span> OrderedDict(<span class="bu">zip</span>(sum_color_frequency_df.ascher_color.values, sum_color_frequency_df.num_occurrences.values))</span>
<span id="cb15-47"><a href="#cb15-47"></a></span>
<span id="cb15-48"><a href="#cb15-48"></a>pendant_color_frequency_dict <span class="op">=</span> build_all_pendant_color_frequencies()</span>
<span id="cb15-49"><a href="#cb15-49"></a>pendant_sum_color_frequency_dict <span class="op">=</span> build_pendant_sum_color_frequencies()</span>
<span id="cb15-50"><a href="#cb15-50"></a>theta <span class="op">=</span> ku.degrees_between_dicts(pendant_color_frequency_dict, pendant_sum_color_frequency_dict)</span>
<span id="cb15-51"><a href="#cb15-51"></a><span class="bu">print</span>(<span class="ss">f"Angle between ALL pendants color frequency vector and pendant pendant sum color frequency vector is </span><span class="sc">{</span>theta<span class="sc">:0.2f}</span><span class="ss">° degrees"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Angle between ALL pendants color frequency vector and pendant pendant sum color frequency vector is 4.50° degrees</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>